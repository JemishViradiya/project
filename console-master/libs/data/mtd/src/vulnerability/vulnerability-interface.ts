import type { PagedResponse, Response } from '../types'
import type { CveSummary, Os, OsCount, OsDetails, OsFilter, SeverityCounts, SeverityCountsByOs } from './vulnerability-types'

export default interface VulnerabilityInterface {
  /**
   * Gets operating systems with their endpoint counts
   */
  getOsCount(): Promise<Response<OsCount[]>>

  /**
   * Gets severity counts
   * @param oss List of Os
   */
  getSeverityCounts(oss: Os[]): Promise<Response<SeverityCounts>>

  /**
   * Gets severity counts per each Os
   * @param oss List of Os
   */
  getSeverityCountsByOs(oss: Os[]): Promise<Response<SeverityCountsByOs[]>>

  /**
   * Gets detailed information associated with the list of Oss
   * @param oss List of Os
   * @param cursor URI to call to get next page of data
   */
  getOsDetails(oss: Os[], filters: OsFilter[], cursor: string): Promise<Response<PagedResponse<OsDetails>>>

  /**
   * Gets Os vulnerability data
   * @param oss List of Os
   * @param cursor URI to call to get next page of data
   */
  getCveSummaries(oss: Os[], cursor: string): Promise<Response<PagedResponse<CveSummary>>>
}
